{% extends "layouts/delta.html" %}

{% set pageName="Delta Excel uploads" %}


{% block content %}

  <div class="panel-nav">

    <div class="controls">
      <button class="govuk-button" id="startBtn">Start</button>
      <button class="govuk-button" id="backBtn">Back</button>
      <button class="govuk-button" id="forwardBtn">Forward</button>
    </div>

  </div>


<div class="container">

  <div class="panel xdelta-text-center">
    <!-- <img src="/public/images/logo.png" alt="MHCLG logo" class="delta-responsive-image" style="width: 240px;"> -->
    <h1 class="govuk-heading-xl govuk-!-margin-top-9 govuk-!-margin-bottom-3">
      Delta 2.0 bulk uploads
    </h1>
    <h1 class="govuk-heading-l ">
      Design exploration
    </h1>    

      <h4 class="govuk-heading-s govuk-!-margin-top-3">
      Updated: Monday 24 February 2025
    </h4>


    <div class="govuk-grid-row  govuk-!-margin-top-6">
      <div class="govuk-grid-column-two-thirds">
        <h2 class="govuk-heading-l">Index</h2>
        <ul class="govuk-list govuk-list--number govuk-body-l govuk-list--spaced">
            <li><a href="#whatDoWeMean">What do we mean by bulk uploads? And a better name?</a></li>
            <li><a href="#whatIsTheProblem">The scale of the problem</a></li>
            <li><a href="#collectionCreationProcess">Existing collection creation process and Excel upload journey</a></li>            
            <li><a href="#validationIssuesAndFixes">Validation issues</a></li>
            <li><a href="#whatCouldGoodLookLike">Collection activity report (with error reporting) [concept]</a></li>
        </ul>
      </div>
    </div>

  </div>


  <div class="panel" id="whatDoWeMean">
    <div class="govuk-grid-row">
      <div class="govuk-grid-column-two-thirds">
        <h2 class="govuk-heading-l">What do we mean by bulk uploads?</h2>
        <p class="govuk-body-l">In this context, 'bulk uploads' refers to entering data into Delta by uploading an Excel document.</p>
        <p>Other methods for bulk uploading data are via XML or through an API, but these are out of scope for this investigation.</p>

        <h2 class="govuk-heading-m">Bulk uploads - a better name?</h2>      
        <p>To date, the uploading of data via an Excel template has been referred to as 'bulk uploads'. As a label we feel it is confusing, not representative of how users see the task and we also believe it constrains creative thinking about new ways Delta could be utilised.</p>            
        <p>It is worth noting that upload single records (i.e. not bulk records) via Excel often provides a better UX (especially for complex returns).</p>      
        <p><strong>We propose renaming 'Bulk uploads' to 'Excel uploads'.</strong></p>       
        

      </div>
    </div>
  </div>  

  <div class="panel" id="whatIsTheProblem">
    <div class="govuk-grid-row">
      <div class="govuk-grid-column-two-thirds">
        <h2 class="govuk-heading-l">What is the scale of the problem?</h2>
        <p>We know that organisations collecting complex data, such as local authorities, often prefer to work in Excel because it fits their existing,internal processes.</p>
        <p>Feedback from data providers indicates that the bulk upload process is complex and prone to errors. As a result, many users opt to enter returns manually, one at a time, using the standard Orbeon forms.</p>
        <p>Analysis of 27 collections by Delta's BA team suggest 20 of them required manual intervention to get the data into a valid format for submission.</p>
        <p><strong>This represents a failure rate of 75% to get [bulk uploaded] data right first time.</strong></p>
        
        <h3 class="govuk-heading-m">Are things improving or getting worse?</h3>
        <p>To date there is little easily accessible insight into bulk upload errors; no reports exist. Extracting and analysing raw data is too time-consuming and not feasible for ongoing monitoring.</p>

        <h3 class="govuk-heading-m">The need for data</h3>

      <img src="/public/images/MIconcept.png" alt="MI Collection Report concept" class="govuk-!-static-margin-bottom-3" style="max-width: 100%;">

        <p>We recommend creating a Management Information (MI) Collection Report to provide real-time, quantified insight. This will:</p>

        <ul class="govuk-list govuk-list--bullet">
          <li>Establish a baseline of the current experience</li>
          <li>Track improvements with quantifiable evidence</li>
          <li>Enable ongoing monitoring to support timely interventions when needed</li>
        </ul>

        <p>There are many other benefits of investing in the creation of an MI Collection Report, but these will be addressed separating on on the dedicated <a href="/MIreport">MI Collections Report prototype</a> page.</p>

      </div>
    </div>
  </div>   

  <div class="panel" id="collectionCreationProcess">
    <div class="govuk-grid-row">
      <div class="govuk-grid-column-two-thirds">
        <h2 class="govuk-heading-l">Collection creation process and Excel upload journey</h2>
        <ul class="govuk-list govuk-list--number">
          <li>Collection manager: creates collection (form) in Orbeon, including validation rules.</li>
          <li>Collection manager: Excel template is exported from Orbeon.<sup>*</sup></li>
          <li>Data provider: downloads Excel template.</li>
          <li>Data provider: inputs data.</li>
          <li>Excel: if inline validation present they correct data in Excel until now warnings.</li>
          <li>Data provider: uploads Excel document.</li>
          <li>Orbeon: processes uploaded file creating a record for each row in the Excel document.</li>
          <li>Orbeon: if there are validation errors the user (data provider) is provided with no details on where the validation errors are or how to address them.</li>
          <li>Data provider: either contacts support for assistance, or abandons process and uploads data one record at a time via the Orbeon form interface.</li>
        </ul>

        <p><strong><sup>*</sup> Need to observe this process and undertand if validation rules are added inline into the Excel template.</strong></p>

      </div>
    </div>
  </div>
  
  <div class="panel" id="validationIssuesAndFixes">
    <div class="govuk-grid-row">
      <div class="govuk-grid-column-two-thirds">
        <h2 class="govuk-heading-l">Validation issues</h2>
        <ul class="govuk-list govuk-list--number">
          <li>Users download the Excel template</li>
          <li>Not all Excel templates have 'inline validation. And the ones that do often have a discrepancy between the in Excel (inline) validation rules and the validation rules applied by Orbeon (at point of upload).</li>
        </ul>

        
        <h2 class="govuk-heading-l">Suggested fixes</h2>
        <ul class="govuk-list govuk-list--number">
          <li>Ensure Excel templates contain inline validation rules</li>
          <li>Ensure validation rules in Excel match and operate in the same way as the validation rules in Orbon (applied at point of upload)</li>
          <li>Create a validation error report that:
            <ul class="govuk-list govuk-list--number">
              <li>Clearly directs the data provider to the specific cells that contain invalid data</li>
              <li>Provide clear guidance on the error and how to fix it.</li>
            </ul>
          </li>
          <li>Inform collections managers if a data provider is repeatedly encountering validation errors on upload.</li>
          <li>Inform collections managers if a data provider abandons a submission made by Excel and instead opts to manually upload the date, via a form.</li>
        </ul>
      </div>
    </div>
  </div>     


  <div class="panel" id="whatCouldGoodLookLike">
    <div class="govuk-grid-row">
      <div class="govuk-grid-column-two-thirds">
        <h2 class="govuk-heading-l">What good could look like</h3>
        <p>From the perspective of data provider&hellip;</p>

        
        <ul class="govuk-list govuk-list--number govuk-list--spaced">
            <li><strong>Download Excel template</strong>: Users can download a pre-formatted Excel template.</li>
            <li><strong>Enter data into the Excel template</strong>: The template includes guidance and inline validation.</li>
            <li><strong>Upload Excel file</strong>: Users can upload the Excel file without needing to convert it to CSV.</li>
            <li><strong>Successful upload</strong>: A confirmation page is displayed.</li>
            <li><strong>Errors in submission</strong>: An error report is generated.
                <ul class="govuk-list govuk-list--number govuk-list--spaced">
                    <li>The error report should highlight which cells contain errors (for example, B36) and provide guidance on how to fix them (such as incorrect data type, out of range, or missing information).</li>
                    <li>Users should see an inline preview of the error data without needing to download or open the file.</li>
                </ul>
            </li>
            <li><strong>Fixing errors</strong>: Users can either correct the errors in Excel and reupload the file or edit the data in the Orbeon form view.</li>
        </ul>

      </div>
    </div>
  </div>

</div>




{% endblock %}

{% block pageScripts %}
<!-- Need to add for any pages with panel scrolling -->
  <script src="/public/javascripts/panelScroller.js"></script>
{% endblock %}





